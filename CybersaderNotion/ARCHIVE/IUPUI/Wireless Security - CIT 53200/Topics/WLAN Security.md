# WLAN Security

# 802.11

- Slow
- Had infrared
- Happened in 1999

# IEEE 802.11 Wireless LAN

- **All have base station and ad-hoc network versions**
- maximum 3 channels without overlap
- some countries like Japan use channel 14, but the US has other stuff on that channel
- 2.4 and 5 GHz are free unlicensed spectrums (they are free to use)

![Untitled](WLAN%20Security/Untitled.png)

- 802.11b
    - 2.4GHz
    - up to 11Mbps
    - more popular into early 2000s
- 802.11a
    - 5GHz
    - up to 54 Mbps
    - OFDM - orthogonal freq-division multiplexing
    - Used to be expensive devices
        - you need a faster clock
    - Doesn’t travel as far
- 802.11n
    - wider spectrum
    - up to 40MHz wide channels
- 802.11g
    - up to 54 Mbps
    - 2.4GHz
- 802.11ac
    - Penetration is not great
    - Devices are more expensive
- 802.11 ax
    - way faster
    - up to 12 Gbps

# Base Station Approach

- Access Points (APs) act as base stations
- Basic Service Set (BSS)
    - all wireless hosts
    - access point (AP): base station
- BSS’s combined to form DS (distribution system)

# 802.11b Security Features

- SSIDs (Service Set ID)
- Cast in “beacon frames” every second
- Beacon frames in plaintext

# Associating with AP

- Shared Key or Open System
    - Open - SSID as key
        - WPA3 - enchanced open
    - Shared Key - requires auth right after association

# Ad Hoc Network Approach

- No AP
- wireless hosts communicate with each other
- Applications:
    - laptop meeting in conference room, car
    - battlefields

# WEP

- phased out 2004
- Two transmissions go over same network sesgment.
- 24-bit IV (init vector) sent in cleartext
- high chance of IV collision
- Packet injection can be used to gather the IVs
- Technical Solution, Other Works
    - WPA/WPA2
    - Encrypted Tunneling Protocols
    - WEPplus
    - Dynamic WEP
- IV
    - super big flaw
    - too short - 24 bits
    - tends to have patterns in the beginning of the IV
- Vulns
    - IV too short
        - collisions can happen if same keystream is used twice
    - Secret key also too short
    - CRC - checksum

# WPA

- Vulns
    - Initialization
    - Security key length
    - Checksum

# WPA2.0

- AES - Advanced Encryption Standard
- CCMP - Counter Mode with Cipher Block Message Authentication Code Protocol
    - Combines Counter Mode & CBC-MAC
        - Counter mode provides privacy
        - CBC-MAC provides data integrity & authentication
- Encryption method that has replaced TKIP
- Security Standard used with WPA2
- Can also be used with WPA Networks
- WPA2 is Wi-Fi Alliance's brand name for 802.11i.
- AES-CCMP uses 128 bit AES encryption keys

## CCMP

- CBC - Cipher Block Chaining
    - Uses random IV
    - Next input depends upon previous output
    - One block’s ciphertext becomes the next’s key
    - cannot be multithreaded
        
        ![Untitled](WLAN%20Security/Untitled%201.png)
        
- CTR Mode
    - Defines a stream cipher using a block cipher
    - can be multithreaded process
    - better performance than CBC
        
        ![Untitled](WLAN%20Security/Untitled%202.png)
        

# WPA3.0 Enterprise

- May not be available to your router today (2022)
- Galois CTR Mode
    - Implements a GHASH to ao authentication along the way
    - GHASH - important but complicated
- Way more performant than CCMP
- GCMP

# WPA3 Enhanced Open

[https://www.diffen.com/difference/WPA2_vs_WPA3](https://www.diffen.com/difference/WPA2_vs_WPA3) 

- For Public Networks
- Authentication is generated by Elliptic Curve Diffie Helman
    - Simultaneous Authentication of Equals, also known as Dragonfly Key Exchang
- WPA2 → WPA3
    - protects from internal MITM
    - Enhanced Open makes it hard for other clients to exploit them on the same AP network
    - Unique Key between each client and the AP network with the Diffie Helman Exchange Process
    - Resistant to dictionary attacks
- Opportunistic Wireless Encryption (OWE)
    - Individualized Data Protection
- WPA3-SAE Transition Mode
    - gets rid of the individualized security
- DPP - Data Provisioning Protocol
    - Wi-Fi Device Provisioning Protocol (DPP) replaces the less secure Wi-Fi Protected Setup (WPS). Many devices in home automation—or the [Internet](https://www.diffen.com/difference/Internet_vs_World_Wide_Web) of Things (IoT)—do not have an interface for password entry and need to rely on smartphones to intermediate their Wi-Fi setup.
    - With Wi-Fi Protected Setup (WPS), the password is communicated from your phone to the IoT device, which then uses the password to authenticate to the Wi-Fi network. But with the new Device Provisioning Protocol (DPP), devices perform mutual authentication without a password.